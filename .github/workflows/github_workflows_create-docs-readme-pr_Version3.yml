name: Create OctoAcme README PR

on:
  workflow_dispatch:
    inputs:
      issue_number:
        description: 'Número da issue para referenciar no PR (ex: 2). Opcional.'
        required: false

jobs:
  create-pr:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Create docs directory (if missing)
        run: |
          mkdir -p docs

      - name: Write README (Português BR)
        run: |
          cat > docs/README.md <<'EOF'
# Documentação de Gerenciamento de Projetos da OctoAcme

Esta pasta reúne os documentos de processo, templates e checklists da OctoAcme para ajudar as equipes a entregar de forma previsível e com qualidade. Em resumo: os projetos começam com um One-pager (resumo do projeto) para capturar o problema, objetivos, métricas de sucesso, stakeholders, cronograma e riscos iniciais. Iniciativas aprovadas avançam para o planejamento, onde o trabalho é desconstruído em incrementos testáveis, critérios de aceitação são definidos, dependências identificadas e um plano de release/marcos é criado.

A execução segue um ritmo estabelecido (daily standups curtos, syncs semanais de entrega, demos ao fim de iterações/marcos) e é acompanhada em um quadro de projeto com estados visíveis (Backlog -> Ready -> In Progress -> In Review -> QA -> Done). O fluxo de pull requests privilegia PRs pequenos, descrição com link para a issue e critérios de aceite, checagens automáticas em CI (testes, lint, scanner de segurança) e pelo menos uma aprovação antes do merge. Papéis são explícitos: Product Manager define resultados e prioridade; Project Manager coordena plano, riscos e comunicação; Desenvolvedores constroem e testam; QA valida qualidade; Stakeholders dão inputs e aprovações.

Riscos, comunicação e gates de qualidade estão incorporados: mantemos um registro simples de riscos, caminhos de escalonamento, templates semanais de status e comunicação de incidentes; releases exigem CI e scanners, testes smoke em staging, notas de release e plano de rollback. A melhoria contínua fecha o ciclo com retrospectivas, itens de ação com responsáveis e datas, que voltam ao backlog para acompanhamento.

Documentos (abra qualquer arquivo abaixo para detalhes):
- [Visão Geral do Gerenciamento de Projetos](./octoacme-project-management-overview.md)
- [Iniciação de Projeto](./octoacme-project-initiation.md)
- [Planejamento de Projeto](./octoacme-project-planning.md)
- [Execução e Acompanhamento](./octoacme-execution-and-tracking.md)
- [Riscos e Comunicação](./octoacme-risks-and-communication.md)
- [Release e Deploy](./octoacme-release-and-deployment.md)
- [Retrospectiva e Melhoria Contínua](./octoacme-retrospective-and-continuous-improvement.md)
- [Papéis e Personas](./octoacme-roles-and-personas.md)
EOF

      - name: Create Pull Request
        uses: peter-evans/create-pull-request@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          branch: docs/add-octoacme-readme
          title: 'docs(octoacme): adicionar docs/README.md com visão geral do processo de gerenciamento de projetos'
          commit-message: 'docs: adicionar docs/README.md com visão geral do gerenciamento de projetos OctoAcme'
          body: |
            Adiciona docs/README.md com uma visão concisa dos processos de gerenciamento de projetos da OctoAcme e links para os documentos detalhados nesta pasta.

            Resumo: iniciação (one-pagers), planejamento (backlog, DoD, plano de release), execução (estados do quadro, fluxo de PR, cadência), riscos & comunicação (registro de riscos, status semanal, escalonamento), gates de release (CI, smoke tests, rollback), e melhoria contínua (retrospectivas -> backlog).

            Relacionado à issue: ${{ github.event.inputs.issue_number || '' }}
          base: main
          labels: 'documentation,process-improvement'
          reviewers: 'marcosvmlopes'
